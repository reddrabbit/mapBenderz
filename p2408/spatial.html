<!DOCTYPE HTML>
<html lang="en">
	<head>
		<title>MapBenderz!</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
		<link rel="stylesheet" href="assets/css/main.css">
	</head>
	<body class="no-sidebar is-preload">
		<div id="page-wrapper">

			<!-- Header -->
				<section id="header">

					<!-- Logo -->
						<h1><a href="#">Advacned Spatial Analytics to Support Emergency Response</a></h1>

					<!-- Nav -->
					<nav id="nav">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li><a href="project.html">Project</a></li>
							<li>
								<a href="#">Process Walkthrough</a>
								<ul>
									<li><a href="mmpk.html">Mobile Map Packages</a></li>
									<li><a href="webapp.html">Web app creation</a></li>
								</ul>
							</li>
							<li><a href="result.html">Result</a></li>
						</ul>
					</nav>
				</section>

			<!-- Main -->
				<section id="main">
					<div class="container">

						<!-- Content -->
							<article class="box post">
								<a href="#" class="image featured"><img src="images/spatialBanner.jpg" alt=""></a>
								<header>
									<h2>Safety Analyzer</h2>
									<p>Integrating Risk Assessment and Routing for Effective Emergency Management</p>
								</header>
								<p>
									Leaflet is a free and open-source JavaScript library for mobile-friendly interactive maps. It provides a simple and intuitive way to display spatial data and allows users to interact with the map and the data. Leaflet, developers can easily customize map styles, add layers with different data sources, and incorporate interactive elements.  
								</p>
								<section>
									<header>
										<h3>Successful Attempt</h3>
									</header>
									<h4>GeoJSON files and Leaflet:</h4>
									<p>
										Our thought process going into this was simple. Have the GeoJSON file reside within the same directory as all the websites assets. The solution was a success, but this depends on the specific needs of the user. If a Basemap is necessary, then this solution would not be a fully offline app. However, in our case, having a basemap was not as important. All we wanted was a way to display the data offline from a web app if the network goes out. 
									</p>
									<h5>Download GeoJSON Data</h5>
									<p>
										First thing is to download a GeoJSON file or convert data to a GeoJSON. We created and then downloaded a GeoJSON file from this 
										<a href="https://geojson.io.">Cool Website for GeoJSON</a>
									</p>
									<p>Once the GeoJSON has been downloaded, move it over to the same workspace where the website’s assets (HTML, CSS, and JavaScript) are stored.</p>
									<div class="photos">
										<img src="images/MylesLeaf1.png" alt="GeoJSON Data">
									</div>
									<h5>Access GeoJSON Data</h5>
									<p>
										In the JavaScript portion of the html document, initiate a fetch parameter that would go ahead to locate the geoJSON and then deliver this data to the map: 
									</p>
									<div class="photos">
										<img src="images/MylesLeaf2.png" alt="GeoJSON Data">
									</div>
									<p>
										Once the JS has been configured as described, run the code from a good server. Like GitHub or a local server made via python. The result looked like this. The line feature is the geoJSON data being called locally: 
									</p>
									<div class="photos">
										<a href="https://reddrabbit.github.io/Technical-Dev-Log/webSolutions/leafletMaps/offlinetest/index.html" target="_blank">Click to view map<img src="images/MylesLeaf3.png" alt="GeoJSON Data"></a>
									</div>
									<header>
										<h3>Drawbacks and Limitations: </h3>
									</header>
									<p>
										Initially, we were running the code via the VS Code live server window. VS Code’s live server is not very solid, and this led us to a CORS error when we tried to load the local GeoJSON data.  Do not use VS CODE for this.   It was an easy fix for us, however, because we were able to deploy a local server using Python.  
										We could not find a way to load up a vector tile package locally. This resulted in the basemap being lost whenever we would set the internet connection mode to offline. 
										GeoJSON data cannot be too large in size either. While it is a great way to load data locally, if the file size is too big, meaning the data contained in it is just too much, it will put a strain on the client as it tries to process the data. This resulted in slow render time for the team when we tried this.  
									</p>



									<header>
										<h3>Unsuccessful Attempt</h3>
									</header>
									<h4>Geopackages and Leaflet:</h4>
									<p>
										The first leaflet functionality we tried was its plugin that’s compatible with geopackages. 
										What’s a geopackage you ask? (hopefully, you asked that...) You can go here to learn about it: <a href="https://www.geopackage.org/">Geopackages</a>. 
										<strong>TL;DR:</strong> It’s another way of storing spatial data as you would a shape file.   In theory, it sounded like the key to solving our problem but alas, it proved to be more of a challenge than we had hoped.  
									</p>
									<h5>Set up API to Access Geopackages Offline: </h5>
									<p>
										The first step is to author the JS file that will be making the requests to Leaflet to retrieve a basemap and load up the Geopackage API to grant access to its JS libraries for accessing local geopackages.  
									</p>
									<div class="photos">
										<img src="images/MylesGP1.png" alt="SETTING UP GEOPACAKGE PLUGIN FOR LEAFLET">
									</div>
									<h5>Load the Geopackage data:</h5>
									<p>
										Next, we added a few lines of code to load the geopackage and set up points of interest markers. We could not generate our own geopackage file from shapefiles, so we decided to use one from the National Geospatial Intelligence Agency's repository. 
									</p>
									<div class="photos">
										<img src="images/MylesGP2.png" alt="SETTING UP GEOPACAKGE PLUGIN FOR LEAFLET">
									</div>
									<h5>Configure the Feature Layers for Query Functions: </h5>
									<p>
										The last step in the JS process is to configure a function that would enable the user to get information on each feature layer stored.
									</p>
									<div class="photos">
										<img src="images/MylesGP3.png" alt="SETTING UP GEOPACAKGE PLUGIN FOR LEAFLET">
									</div>
									<h5>Set up HTML to View Results: </h5>
									<p>
										Finally, we created an HTML document and linked the local JS file with other JS libraries to facilitate the offline mapping solution using geopackages.  
									</p>
									<div class="photos">
										<img src="images/MylesGP0.png" alt="HTML DOC FOR LEAFLET GEOPACAKGE PLUGIN">
									</div>
								</section>
								<section>
									<header>
										<h3>Drawbacks and Limitations: </h3>
									</header>
									<p>
										While the geopackage idea seemed like a great idea, we were first limited in trying to get a geopackage of our own. We tried using a few web pages to convert a shapefile into a geopackage, but they were not very fruitful.  
										The JavaScript libraries to support the development were either outdated or no longer available on the National Geospatial-Intelligence's repository. And while the idea seemed like it would have been fantastic, the script for deployment had some codes that would rely on an internet connection to grab a tiled basemap from leaflet. We spent quite a bit of time trying to find alternatives, but they all led nowhere.  
										We were left with the option of referencing a geopackage from a repository on GitHub and then overlaying that geopackage on top of a leaflet basemap. To mimic an offline solution, we added a print option to the map. This was not as bright an idea as we had hoped. Unless you are looking to have a static display of the map, then this would be ideal. However, 99% of the time, web app users want to interact with the maps, so do not attempt this. The result, which ended up as just a base
										leaflet map can be found here: <a href="https://reddrabbit.github.io/Technical-Dev-Log/webSolutions/leafletMaps/GPKGLeaflet.html">Not So Offline Map</a>
									</p>
									
								<!-- Concluding Section -->
									<header>
										<h3>In Conclusion</h3>
									</header>
									<p>
										Loading up a local version of the data, however, is a great idea. While it does require an internet connection to get things going, once it runs, it can go offline, and the data will be available. With a locally made tile pack for a basemap, this solution just might be able to solve the problem of offline map needs. 
									</p>
									<p>
										The geopackage option was not a very good idea because it lacked resources and ample documentation. The project required us to use existing solutions in tandem with one another where possible, and not to reinvent the wheel. Itt would have made for a great solution if only resources were maintained.  
									</p>
								</section>
							</article>

					</div>
				</section>

			<!-- Footer -->
			<section id="footer">
				<div id="copyright">
					<ul class="links">
						<li>&copy; MapBenderz</li><li>Thank you for showing up!</li>
					</ul>
				</div>
			</section>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.dropotron.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>